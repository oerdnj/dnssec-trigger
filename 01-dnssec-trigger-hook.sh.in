#!0SHELL0
#
# NetworkManager trigger for in dispatcher.d
# config items
nmcli="nmcli"

# implementation
ifname="$1"
action="$2"

# get ips from NetworkManager
ips="`$nmcli -f IP4-DNS,IP6-DNS dev list | awk '{print $2;}'`"
# fix whitespace
ips=`echo $ips`

logger "dnssec-trigger-hook(networkmanager) $ifname $action DNS $ips"
dnssec-trigger-control submit "$ips"
exit 0
